!function(h){h.fn.extend({beforeAfter:function(){h(this).each(function(){var o=h(this),e=h("img:last",o);afterImageH=e.height(),afterImageW=e.width(),h(o).height(afterImageH),h("img:first",o).wrap('<div class="ba-slider-before-image"/>').width(afterImageW),h(".ba-slider-before-image",o).css({width:l(50)}),h("img",o).addClass("ba-slider-image"),html='<div class="ba-control"><div class="ba-control-area"><div class="ba-control-bar"><span class="ba-left-arrow" /><span class="ba-control-handle" /><span class="ba-right-arrow" /></div></div></div>',o.append(html);var i,r,t=o.find(".ba-control"),n=t.find(".ba-control-area");o.find("*");function a(e){var a=e.pageX-i,t=a/r*100;a=Math.floor(Math.min(Math.max(0,t),100)),n.css({left:l(a)}),h(".ba-slider-before-image",o).width(l(a))}function f(){h(document).off("mousemove",a).off("mouseup",f)}function s(){afterImageH=e.height(),afterImageW=e.width(),h(".ba-slider",o).height(afterImageH),h(".ba-control",o).height(afterImageH),h(".ba-slider-before-image img",o).width(afterImageW),o.height(afterImageH)}function l(e){return e+"%"}n.css({left:l(50)}),h(window).on("resize",s),n.on("mousedown",function(e){e.preventDefault(),i=t.offset().left,n.offset().left-i,r=t.width(),h(document).on("mousemove",a).on("mouseup",f)}),o.on("mouseover",function(e){h(".ba-left-arrow, .ba-right-arrow, .ba-control-handle",o).filter(":not(:animated)").fadeIn()}),o.on("mouseleave",function(e){h(".ba-left-arrow, .ba-right-arrow, .ba-control-handle",o).fadeOut()}),o.on("click",function(e){e.preventDefault();var a=(e.pageX-h(this).offset().left)/t.width()*100;posX=Math.round(Math.min(Math.max(0,a),100)),n.stop().animate({left:l(posX)}),h(".ba-slider-before-image",o).stop().animate({width:l(posX)})}),o.on("touchmove",function(e){e.preventDefault();var a=(e.originalEvent.targetTouches[0].pageX-t.offset().left)/t.width()*100;posX=Math.round(Math.min(Math.max(0,a),100)),n.css({left:l(posX)}),h(".ba-slider-before-image",o).width(l(posX))}),s()})}})}(jQuery);